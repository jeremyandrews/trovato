{% extends "page--admin.html" %}

{% block content %}
<div class="admin-header">
    <h2>Content</h2>
    <a href="/admin/content/add" class="button button--primary">Add content</a>
</div>

<div class="admin-card">
    <form class="filter-form" method="get" action="/admin/content">
        <div class="filter-row">
            <div class="filter-item">
                <label for="type">Type</label>
                <select id="type" name="type">
                    <option value="">- Any -</option>
                    {% for ct in content_types %}
                    <option value="{{ ct.machine_name }}" {% if type_filter == ct.machine_name %}selected{% endif %}>{{ ct.label }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="filter-item">
                <label for="status">Status</label>
                <select id="status" name="status">
                    <option value="">- Any -</option>
                    <option value="1" {% if status_filter == "1" %}selected{% endif %}>Published</option>
                    <option value="0" {% if status_filter == "0" %}selected{% endif %}>Unpublished</option>
                </select>
            </div>
            <div class="filter-item">
                <button type="submit" class="button button--secondary">Filter</button>
            </div>
        </div>
    </form>
</div>

<div class="admin-card">
    {% if items %}
    <table class="table">
        <thead>
            <tr>
                <th>Title</th>
                <th>Type</th>
                <th>Author</th>
                <th>Status</th>
                <th>Updated</th>
                <th>Operations</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
            <tr>
                <td>
                    <a href="/admin/content/{{ item.id }}/edit">{{ item.title }}</a>
                </td>
                <td>{{ item.type }}</td>
                <td>{{ authors[item.author_id] | default(value="Unknown") }}</td>
                <td>
                    {% if item.status == 1 %}
                    <span class="status status--published">Published</span>
                    {% else %}
                    <span class="status status--unpublished">Unpublished</span>
                    {% endif %}
                </td>
                <td>{{ item.changed | date(format="%Y-%m-%d %H:%M") }}</td>
                <td>
                    <a href="/admin/content/{{ item.id }}/edit">Edit</a>
                    &middot;
                    <form method="post" action="/admin/content/{{ item.id }}/delete" style="display: inline;">
                        <button type="submit" class="link-button" onclick="return confirm('Are you sure you want to delete this content?')">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>No content found. <a href="/admin/content/add">Create some now</a>.</p>
    {% endif %}
</div>

<style>
    .filter-form {
        margin-bottom: 0;
    }
    .filter-row {
        display: flex;
        gap: 1rem;
        align-items: flex-end;
    }
    .filter-item {
        display: flex;
        flex-direction: column;
        gap: 0.25rem;
    }
    .filter-item label {
        font-size: 0.875rem;
        font-weight: 500;
    }
    .filter-item select {
        padding: 0.375rem 0.5rem;
        border: 1px solid #ccc;
        border-radius: 0.25rem;
    }
    .status {
        display: inline-block;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.875rem;
    }
    .status--published {
        background: #d4edda;
        color: #155724;
    }
    .status--unpublished {
        background: #fff3cd;
        color: #856404;
    }
    .link-button {
        background: none;
        border: none;
        color: var(--primary);
        cursor: pointer;
        padding: 0;
        font: inherit;
    }
    .link-button:hover {
        text-decoration: underline;
    }
</style>
{% endblock %}
